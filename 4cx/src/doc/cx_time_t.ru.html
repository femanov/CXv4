<HTML>
<HEAD>
<TITLE>cx_time_t -- что это такое</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="style.css">
</HEAD>
<BODY>

<H1><CODE>cx_time_t</CODE> -- что это такое</H1>

	<H2>Определение</H2>

<P>Тип <CODE>cx_time_t</CODE> предназначен для представления времени с
наносекундной точностью.  Он определяется в файле <TT>cx.h</TT> следующим
образом:

<BLOCKQUOTE><PRE>
typedef struct
{
    long  sec;
    long  nsec;
} cx_time_t;
</PRE></BLOCKQUOTE>

<P>Т.е., он аналогичен стандартному типу <CODE>struct timeval</CODE>, с той
лишь разницей, что вместо поля "микросекунды" содержит поле "наносекунды". 
В поле <CODE>sec</CODE> так же содержится количество секунд с 00:00:00
01-01-1970.


	<H2>Использование</H2>

<P>Тип <CODE>cx_time_t</CODE> применяется в CXv4 для маркирования времени
измерения каналов (timestamps), а также для указания возрастов свежести
(fresh ages).


		<H3>Особенности при использовании в timestamp'ах</H3>

<P>При использовании в качестве timestamp'ов для поля <CODE>sec</CODE> есть
специальное значение <CODE>CX_TIME_SEC_NEVER_READ</CODE>=1.

<P>Такое значение было выбрано потому, что при использовании в системах
управления время 01 секунда 1-января-1970 практического смысла не имеет, но
при сравнении с любым осмысленным временем оно будет значительно "старше".


		<H3>Особенности при использовании в возрастах свежести
		(fresh ages)</H3>

<P>Нулевое значение возраста свежести -- т.е.,

<CODE>sec==0 &amp;&amp; nsec==0</CODE>

-- указывает, что для данного канала понятие "возраст свежести" лишено
смысла (или свежесть может считаться бесконечной).

<P>Это используется для каналов записи (т.к. записанное значение остаётся до
следующего принудительного изменения и никогда не "протухает"), а также для
каналов, чьё значение измениться не может (например, версия прошивки
устройства или его серийный номер).


	<H2>Конверсия в другие форматы</H2>

<P>Преобразование из <CODE>cx_time_t</CODE> (t) в <CODE>struct
timeval</CODE> (tv):

<BLOCKQUOTE><PRE>
tv.tv_sec  = t.sec;
tv.tv_usec = t.nsec / 1000;
</PRE></BLOCKQUOTE>

<P>Преобразование из <CODE>cx_time_t</CODE> (t) в скалярное вещественное
число (<CODE>double</CODE> ft):

<BLOCKQUOTE><PRE>
ft = t.sec + t.nsec / 1000000000.;
</PRE></BLOCKQUOTE>


</BODY>
</HTML>
