<HTML>
<HEAD>
<TITLE>Структура директорий исходных файлов CXv4</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="style.css">
</HEAD>
<BODY>

<H1>Структура директорий исходных файлов CXv4</H1>


	<H2>Введение</H2>

<P>Полная система CXv4 состоит из 4 частей (под-проектов):

  <UL TYPE=square>

  <LI><A HREF="#4cx"><TT>4cx/</TT></A> -- ядро системы: библиотеки и
стандартные программы.

  <LI><A HREF="#hw4cx"><TT>hw4cx/</TT></A> -- поддержка конкретной
аппаратуры (драйверы и прочие сопутствующие файлы).  "hw" -- HardWare.

  <LI><A HREF="#sw4cx"><TT>sw4cx/</TT></A> -- ПО для конкретных установок,
использующих CXv4 (ВЭПП-5, ВЭПП-4, ЛИУ-2, стенд ЭЛС, ...).  "sw" --
SoftWare.

  <LI><A HREF="#x-compile"><TT>x-compile/</TT></A> -- набор сред для
кросс-компиляции под Linux для низкоуровневых аппаратных платформ,
используемых в <TT>hw4cx/</TT>.

  </UL>

<P>Предполагается, что все эти поддиректории располагаются в директории
<TT>~/work/</TT>.


	<H2 ID=4cx>Директории в <TT>4cx/</TT></H2>

<P>Непосредственно в <TT>4cx/</TT> располагаются 2 директории: <TT>src/</TT>
и <TT>exports/</TT>.  В последней подготавливается дерево директорий для
инсталляции (подробнее см. 

<A HREF="DIRECTORIES.ru.html">DIRECTORIES.ru.html</A> и

<A HREF="BUILD.ru.html">BUILD.ru.html</A>), а <TT>src/</TT> рассматривается
ниже.

<P>Директории в <TT>4cx/src/</TT>:

  <DL>

  <DT><TT>doc</TT></DT><DD>Документация.</DD>

  <DT><TT>scripts</TT></DT><DD>Скрипты, используемые системой сборки.</DD>

  <DT><TT>include</TT></DT><DD><CODE>#include</CODE>-файлы.</DD>

  <DT><TT>lib</TT></DT><DD>Библиотеки.</DD>

  <DT><TT>programs</TT></DT><DD>Программы.</DD>

  </DL>


	<H2 ID=hw4cx>Директории в <TT>hw4cx/</TT></H2>

<P>Всё, требуемое для поддержки конкретной аппаратуры: драйверы, файлы
определения интерфейсов драйверов, экраны, а также поддержка
кросс-компиляции под другие архитектуры.

  <DL>

  <DT><TT>drivers</TT></DT><DD>Собственно драйверы:

    <DL>

    <DT><TT>camac</TT></DT><DD>CAMAC, в настоящий момент поддерживается
только платформа CM5307/PPC.

<P>В поддиректории <TT>src/</TT> находятся исходники, а в
<TT>cm5307_ppc_drvlets/</TT> собираются файлы-драйвлеты <TT>.drvlet</TT> под
CM5307/PPC.</DD>

    <DT><TT>can</TT></DT><DD>Драйверы для устройств, подключаемых через CAN-bus
по протоколу им.Козака (он же CAN-BINP).

      <DL>

      <DT><TT>src</TT></DT><DD>Исходные тексты драйверов и общей части
layer'а "cankoz".</DD>

      <DT><TT>local</TT></DT><DD>Здесь собираются драйверы под
хост-архитектуру.</DD>

      <DT><TT>socketcan</TT></DT><DD>Поддержка SocketCAN -- здесь собирается
layer <CODE>sktcankoz_lyr</CODE> и монитор <CODE>sktcanmon</CODE>.</DD>

      <DT><TT>c4l-cangw</TT></DT><DD>Поддержка контроллера CANGW -- здесь
собирается под архитектуру ppc860 микросервер <CODE>v4c4lcanserver</CODE>
<I>(объединяющий в себе CAN-драйверы, layer для работы с CAN-bus через API
can4linux, а также внешний интерфейс на основе remsrv)</I> и монитор
<CODE>c4lcanmon</CODE>.</DD>

      </DL>

</DD>

    <DT><TT>cpci</TT></DT><DD>Драйверы для устройств PCI/CompactPCI.

<P>В настоящий момент (01.11.2016) -- драйверы для устройств с
VendorID=0x4626 (производства ИЯФ, Батраков &amp; Co.): ADC200ME, ADC812ME,
DL200ME и используемый этими драйверами layer <CODE>pci4624_lyr</CODE>.</DD>

    <DT><TT>eth</TT></DT><DD>Драйверы для устройств, подключаемых по
Ethernet.

<P>В настоящий момент (01.11.2016) -- CCD-камера Оттмара
(<CODE>ottcam</CODE>) и BPM для линака ВЭПП-5 Стюфа-Карпова
(<CODE>slbpm</CODE>).</DD>

    <DT><TT>serial</TT></DT><DD>Драйверы для устройств, подключаемых по
последовательным линиям RS-232/422/485.

<P>В настоящий момент (01.11.2016) -- только КШД-485 им.Волкова
(<CODE>kshd485</CODE>), но как под Linux-x86, так и под Moxa UC-7112
(поддиректория <TT>moxa/</TT>).

</DD>

    </DL>

(Поддержка VME в настоящий момент (01.11.2016) отсутствует за ненадобностью.)

</DD>

  <DT><TT>given</TT></DT><DD>Сторонние файлы, требуемые для поддержки
специфического железа.

  <DT><TT>include</TT></DT><DD><CODE>#include</CODE>-файлы.

<P>В первую очередь -- <TT>*_drv_i.h</TT>-определения интерфейсов драйверов
в <TT>include/drv_i/</TT>.

<P>Кроме того, общие определения для драйверов CAN, cPCI и RS485.</DD>


  <DT><TT>pzframes</TT></DT><DD>Клиентская поддержка для pzframe-устройств
(быстрые АЦП, CCD-камеры, ИПП, VsDC): индивидуальные утилиты экранов,
knobplugin'ы, программа <CODE>pzframeclient</CODE> (аналог программы
<CODE>pult</CODE> с поддержкой pzframe-knobplugin'ов).</DD>

  <DT><TT>screens</TT></DT><DD>Файлы "экранов" для всех устройств (за
исключением тех, что поддерживаются в <TT>pzframes/</TT>, и нескольких
тривиальных).</DD>

  <DT><TT>types</TT></DT><DD>Файлы <TT>*.devtype</TT> -- определения типов
устройств для сервера.</DD>

  <DT><TT>x-build</TT></DT><DD>Локальная поддержка кросс-сборки.  Здесь, в
поддиректориях <TT>arm-linux</TT> и <TT>ppc860-linux</TT>, собираются под
соответствующие платформы специфичные для CX библиотеки (libmisc, libuseful,
libcxscheduler, librem*, ...).

<P>Используется при сборке драйверов в <TT>drivers/</TT>.</DD>

  </DL>


	<H2 ID=sw4cx>Директории в <TT>sw4cx/</TT></H2>

<P>В настоящий момент нет разделения файлов по установкам и файлы от всех
проектов лежат вместе.

  <DL>

  <DT><TT>configs</TT></DT><DD>Конфигурационные файлы:</DD>

    <UL TYPE=square>

    <LI><TT>devlist-HOSTNAME-N.lst</TT>: списки аппаратуры для серверов, в

<A HREF="cxsd-devlist.ru.html">формате "devlist"</A>.

<P>Также сопутствующие <TT>.m4</TT>-файлы.

    <LI><TT>cx-starter-HOSTNAME.conf</TT>: списки программ для CX-starter.

<P>Также файл <TT>srvparams.conf</TT>, с параметрами для запуска конкретных
серверов и групп серверов.

    </UL>

  <DT><TT>drivers</TT></DT><DD>Специфичные драйверы для конкретных
установок.

<P>В настоящее время это в основном

<A HREF="lib/vdev.ru.html">vdev</A>-драйверы, в т.ч.:

    <UL TYPE=square>

    <LI>ist_cdac20: источники ИСТ, управляемые через CDAC20, включая
реверсивные (ИСТР).

<P>Поддерживает также совместимые по управлению источники в форм-факторе
"Евромеханика 3U", использующие CEAC51; такие, как "новый" В1000, ВЧ1300,
В500.

    <LI>v1k_cdac20: источники В1000, управляемые через CDAC20.

    <LI>v3h_a40d16: источники ВЧ300, управляемые (комплектами по 8 штук)
через CANDAC16+CANADC40.

    <LI>mps20_ceac124: источники MPS20, управляемые через CEAC124.

    <LI>vepp4_gimn: ГИМН, стоящий во впуске из канала К500 в ВЭПП-3М. 
Управляется через CGVI8M+CPKS8.

    </UL>

</DD>

  <DT><TT>include</TT></DT><DD><CODE>#include</CODE>-файлы; в настоящее
время -- <TT>*_drv_i.h</TT>-определения интерфейсов драйверов в
<TT>include/drv_i/</TT>.</DD>

  <DT><TT>screens</TT></DT><DD>"Экраны" -- файлы <TT>*.subsys</TT> для
программ управления, а также сопутствующие <TT>.m4</TT>-файлы.</DD>

  <DT><TT>types</TT></DT><DD>Файлы <TT>*.devtype</TT> -- определения типов
устройств для сервера.

<P>В этой директории лежат <TT>.devtype</TT>-файлы для драйверов,
специфичных для конкретных установок, содержащихся в директории
<TT>drivers/</TT>.</DD>

  <DT></DT><DD></DD>

  <DT><TT>xmclients/</TT></DT><DD>Клиентские программы на основе Motif.

<P>В настоящее время -- только от ЛИУ-2.</DD>

  </DL>


	<H2 ID=x-compile>Директории в <TT>x-compile/</TT></H2>

<P>Имеются следующие директории, поддерживающие кросс-компиляцию на
платформе Linux-x86 для соответствующих архитектур:

  <DL>

  <DT>arm-linux_1.3</DT><DD>Linux для процессора ARM микрокомпьютера Moxa
UC-7112 (RS-485).</DD>

  <DT>ppc860-linux</DT><DD>Linux для процессора PowerPC 860.

<P>Используется в контроллерах авторства В.Мамкина: CM5307/PPC (CAMAC),
CANGW (CAN-bus), BIVME2 (VME).</DD>

  <DT>mcf5200-linux</DT><DD>uClinux для процессора Motorola Coldfire
MCF5200.

<P>Использовалась на первом варианте CAMAC-контроллера CM5307, в настоящее
время не применяется, а директория оставлена в архивных целях.</DD>

  </DL>

<P>Эти среды кросс-компиляции используются в <TT>hw4cx/x-build/</TT>.


</BODY>
</HTML>
